<!doctype html>
<html>
	<head>
		<title>Progress Bars</title>
		<style>
			.progress-container {
				width: 300px;
				border: 1px solid #ccc;
				margin-bottom: 20px;
				position: relative;
			}

			.progress-bar {
				width: inherit;
				height: 20px;
				background: #f0f0f0;
				border: 1px solid black;
				margin-bottom: 20px;
			}

			.progress-fill {
				height: 100%;
				background: linear-gradient(45deg, #4caf50, #45a049);
				width: 0%;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div
				class="progress-bar"
				role="progressbar"
				aria-valuenow="70"
				aria-valuemin="0"
				aria-valuemax="100"
			>
				<div class="progress-fill"></div>
			</div>
			<div
				class="progress-bar"
				role="progressbar"
				aria-valuenow="70"
				aria-valuemin="0"
				aria-valuemax="100"
			>
				<div class="progress-fill"></div>
			</div>
			<div
				class="progress-bar"
				role="progressbar"
				aria-valuenow="70"
				aria-valuemin="0"
				aria-valuemax="100"
			>
				<div class="progress-fill"></div>
			</div>
		</div>

		<script>
			const durations = [1000, 2000, 1500];
			const progressBars = document.querySelectorAll('.progress-fill');
			const container = document.querySelectorAll('.progress-container');

			function animateProgressBar(progressBar, duration) {
				return new Promise((resolve) => {
					// Add an event listener that resolves the promise when the transition ends
					progressBar.addEventListener(
						'transitionend',
						() => {
							resolve();
						},
						{ once: true },
					); // The { once: true } option ensures the listener is automatically removed.

					// Set the transition duration
					progressBar.style.transitionDuration = `${duration}ms`;

					// Start the animation
					// We use a small setTimeout to ensure the transition listener is registered first
					setTimeout(() => {
						progressBar.style.width = '100%';
					}, 10);
				});
			}

			async function runProgressBars() {
				for (let i = 0; i < progressBars.length; i++) {
					await animateProgressBar(progressBars[i], durations[i]);
				}
			}

			runProgressBars();
		</script>
	</body>
</html>
